---
layout: page
title: 2-5. マージソート【自動採点システム:5点，仕様:5点】
---

マージソートのアルゴリズムは部分配列のソートとマージの再帰的な手続で記述することができる．問題 2-4 で作成したマージ関数を用いてマージソートのアルゴリズムを実装してみよう．

## 問題
与えられた配列データを**マージソート**（merge sort）により<font color="red">昇順</font>に並べ替えるプログラムを作成せよ．また，「ふたつの数の比較」の回数を数えよ．

プログラムは以下の仕様を満たすこと（以下の仕様を満たしたプログラムに5点を加点する）．

- グローバル変数および静的変数を使用してはいけない．
- データファイルの内容は，以下の通りである．
  - データファイルの 1 行目に，ソートすべきデータの個数 $n$ が記載されている．なお，$n$ の値は 2 のべき乗である．
  - データファイルの 2 行目に，ソートすべき $n$ 個のデータが半角スペースで区切られて記載されている．なお，すべてのデータの値は，`int` 型で収まる範囲内の正の整数である．
- 配列の動的確保
  - ソートすべき $n$ 個のデータを読み込む際には，データの格納に必要なメモリ領域を動的に確保すること．
  - 動的に確保したメモリ領域は処理が完了した後に解放すること．
- データファイルの読み込は`main` 関数内で行うこと.
- 配列をマージソートによってソートする `merge_sort` 関数を作成すること．ただし，`merge_sort` 関数は以下の仕様を満すこと．
- 配列データの任意の範囲に対し，マージソートのアルゴリズムを適用する `merge_sort` 関数を作成する．
  - 動的に確保した配列とソート範囲の配列の添字を表す 2 個の整数 $a,b (a \leq b<n)$を引数とする．`merge_sort` 関数は部分配列 array[$a$] 〜 array[$b$] を昇順にソートする関数であること．
  - ソートの際に実行された比較命令の回数を`merge_sort` 関数の戻り値とすること．
  - 再帰呼び出しを用いること．
  - 問題2-4で作成した `merge` 関数を用いること．
- 入力された $n$ 個の配列データの全体に対して `merge_sort` 関数を適用せよ．
- ソート後の出力
    - ソートした配列データの各要素を標準出力に書き出し，改行後に比較回数を書き出すこと．
	- `merge` 関数内で比較した回数を表示してはいけない．
    - `merge` 関数内でソート後の配列データを表示してはいけない．
- 配列データの表示は各要素を半角スペースで区切って標準出力に書き出し，各表示の末尾には改行文字 `\n` を付けること．
	- 配列データを表示する際に最終要素と改行文字 `\n` の間に半角スペースをいれないこと．

## 実行例

### (1)

入力されるデータファイル ([mergesort_data1.txt](./mergesort_data1.txt)) の例

```
2
1 2
```


リダイレクション '<' を用いて `mergesort_data1.txt` の内容を標準入力から読み込む．

```
$ ./a.out < mergesort_data1.txt
```

`mergesort_data1.txt` に対する実行結果の例（`>` は標準出力を示し，`⊔` は半角スペースを示す．）

```
> 1⊔2
> 1
```

### (2)

入力されるデータファイル ([mergesort_data2.txt](./mergesort_data2.txt)) の例

```
4
4 3 2 1
```

`mergesort_data2.txt` に対する実行結果の例（`>` は標準出力を示し，`⊔` は半角スペースを示す．）

```
> 1⊔2⊔3⊔4
> 4
```

### (3)

入力されるデータファイル ([mergesort_data3.txt](./mergesort_data3.txt)) の例

```
8
2 4 3 1 8 7 6 5
```

`mergesort_data3.txt` に対する実行結果の例（`>` は標準出力を示し，`⊔` は半角スペースを示す．）

```
> 1⊔2⊔3⊔4⊔5⊔6⊔7⊔8
> 13
```

## ヒント

- マージソートのアルゴリズムについては，[課題解説資料](http://ecei-tohoku.github.io/ppa/kadai2_337178b351abf0177482d130d0936df8e78e90b595266aacbe1b34b7965c03f0/kadai2-intro.pdf) p.19 も参考のこと．
- マージソートにおける「分割」を再帰の考え方でプログラムしてみよう．まずは具体的な配列でプログラムの挙動を考え，それを一般的な変数を含む形で書いてみるとよい．ここでは，要素数 8 の配列で具体的に考えてみよう．
    - main 関数「範囲 0 ~ 7 をマージソートせよ」
    - 「範囲 0 ~ 7 をマージソートせよ」ということは，(1) 範囲 0 ~ 3 をマージソートし，かつ (2) 範囲 4 ~ 7 をマージソートしたあと，それぞれをマージする，ということである．
    - 上の挙動のうち，(1)「0 ~ 3 の範囲をマージソートせよ」ということは，範囲 0 ~ 1 をマージソートし，かつ範囲 2 ~ 3 をマージソートしたあと，それぞれをマージする，ということである．同様に，(2)「4 ~ 7 を（...以下省略）
    - これを，[課題2-3] で学んだような再帰呼び出しで書くには，どうしたらよいだろうか．
