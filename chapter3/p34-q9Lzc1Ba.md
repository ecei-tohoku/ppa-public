---
layout: page
title: 3-4. 常微分方程式【発展】
---

物理法則は多くの場合，微分方程式の形で表現される．微分方程式の数値解析による解法は，物理学の理解と工学応用に大きく貢献してきた．この問題では，常微分方程式の数値解法を学ぶとともに，実際にニュートンの運動方程式を解くプログラムを作成する．

変数$x$の有限区間$x=[a, b]$で定義される未知関数$y(x)$に対する常微分方程式
$$
\frac{dy}{dx} = f(x, y)  (1)
$$
を考える．また，境界条件としては$y(a) = y_{a}$が与えられるものとする．p3-3と同じように，区間$[a, b]$を有限の区間に分割し，微分を近似することで，この常微分方程式に対する数値解法が得られる．ここでは，３つの方法を実装してもらう．

---
#### 1. オイラー法
---

区間$x=[a, b]$をn個に等間隔$h = (b-a)/n$に分ける：
$$
x_{0}=a, x_{1}=a+h, x_{2}=a+2h..., x_{n-1}=a+(n-1)h, x_{n} = b  (2)
$$
これらの点における$y(x)$を
$$
y_{0}=y(x_{0}), y_{1}=y(x_{1}), ..., y_{n} = y(x_{n})  (3)
$$
とする．式(1)の左辺の微分をこれらの点上での値で近似すると
$$
\frac{dy}{dx} \approx \frac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} = f(x_{i}, y_{i})\\
y_{i+1} = y_{i}+hf(x_{i}, y_{i})  (4)
$$
と書くことができる．初期値$y_{0}$が与えられれば，次の$y_{1}$は式(4)を用いて$y_{1} = y_{0}+hf(x_{0}, y_{0})$と計算でき，同じように繰り返していけば$y_{n}$まで計算できる．この手法を”オイラー法”と呼ぶ．この方法もp3-3のリーマン和と同様，計算の精度が悪いため，実践的に使われることはない．

---
#### 2. ２次のルンゲ・クッタ法（中点法）
---

$$
k_{1} = h*f(x_{i}, y_{i})
k_{2} = h*f(x_{i}+h/2, y_{i}+k_{1}/2)
y_{i+1} = y_{i}+k_{2}
$$

---
#### 3. ４次のルンゲ・クッタ法
---

$$
k_{1} = h*f(x_{i}, y_{i})
k_{2} = h*f(x_{i}+h/2, y_{i}+k_{1}/2)
k_{3} = h*f(x_{i}+h/2, y_{i}+k_{2}/2)
k_{4} = h*f(x_{i}+h, y_{i}+k_{3})
y_{i+1} = y_{i}+\frac{k_{1}}{6}+\frac{k_{2}}{3}+\frac{k_{3}}{3}+\frac{k_{4}}{6}
$$


---
## 問題
---

ルンゲ・クッタ法に基づいて常微分方程式の解を求める関数を作成し，それを使って入力された常微分方程式を解くプログラムを作成せよ．
よりニュートンの運動方程式。。。

$$
\frac{d\mathbf{v}}{dt} = \frac{F(\mathbf{v}, t)}{m}
$$


---
## 仕様
---

プログラムは以下の仕様を満たすこと．


---
### 参考情報
---
