---
layout: page
title: 3-4. 常微分方程式【発展】
---

物理法則は多くの場合，微分方程式の形で表現される．微分方程式の数値解析による解法は，物理学の理解と工学応用に大きく貢献してきた．この問題では，常微分方程式の数値解法を学ぶとともに，実際にニュートンの運動方程式を解くプログラムを作成する．

変数$x$の有限区間$x=[a, b]$で定義される未知関数$y(x)$に対する常微分方程式
$$
\frac{dy}{dx} = f(x, y)  (1)
$$
を考える．$f(x, y)$は既知の関数とし，境界条件としては$y(a) = y_{a}$が与えられるものとする．p3-3と同じように，区間$[a, b]$を有限の区間に分割し，微分を近似することで，この常微分方程式に対する数値解法が得られる．ここでは，３つの方法を実装してもらう．

---
#### 1. オイラー法
---

区間$x=[a, b]$をn個に等間隔$h = (b-a)/n$に分ける：
$$
x_{0}=a, x_{1}=a+h, x_{2}=a+2h..., x_{n-1}=a+(n-1)h, x_{n} = b  (2)
$$
これらの点における$y(x)$を
$$
y_{0}=y(x_{0}), y_{1}=y(x_{1}), ..., y_{n} = y(x_{n})  (3)
$$
とする．式(1)の左辺の微分をこれらの点上での値で近似すると
$$
\frac{dy}{dx} \approx \frac{y_{i+1}-y_{i}}{x_{i+1}-x_{i}} = f(x_{i}, y_{i}) \\
y_{i+1} = y_{i}+hf(x_{i}, y_{i})  (4)
$$
と書くことができる．初期値$y_{0}$が与えられれば，次の$y_{1}$は式(4)を用いて$y_{1} = y_{0}+hf(x_{0}, y_{0})$と計算でき，同じように繰り返していけば$y_{n}$まで計算できる．この手法を”オイラー法”と呼ぶ．この方法もp3-3のリーマン和と同様，計算の精度が低くため，実践的に使われることはほとんどない．

---
#### 2. ２次のルンゲ・クッタ法（中点法）
---

オイラー法が精度が低い理由の一つは，右辺の関数$f(x, y)$を点$(x_{i}, y_{i})$でしか参照していないことにある．より精度の高い手法では，$(x_{i}, y_{i})$と$(x_{i+1}, y_{i+1})$の間の点における$f$を参照する．

２次のルンゲ・クッタ法あるいは中点法と呼ばれる手法では，$x_{i}$と$x_{i+1}$の中点$x_{i}+h/2$における$y(x_{i}+h/2)$をオイラー法で求めておき，次に$(x_{i}+h/2, y(x_{i}+h/2))$における$f$を参照して$y_{i+1}$を計算する．式で書くと以下のようになる：
$$
k_{1} = hf(x_{i}, y_{i}) \\
k_{2} = hf(x_{i}+h/2, y_{i}+k_{1}/2) \\
y_{i+1} = y_{i}+k_{2}
$$

---
#### 3. ４次のルンゲ・クッタ法
---

２次のルンゲ・クッタ法を発展させた手法が ４次のルンゲ・クッタ法であり，中点だけでなく$x_{i}$と$x_{i+1}$における$f$も参照する：
$$
k_{1} = hf(x_{i}, y_{i}) \\
k_{2} = hf(x_{i}+h/2, y_{i}+k_{1}/2) \\
k_{3} = hf(x_{i}+h/2, y_{i}+k_{2}/2) \\
k_{4} = hf(x_{i}+h, y_{i}+k_{3}) \\
y_{i+1} = y_{i}+\frac{k_{1}}{6}+\frac{k_{2}}{3}+\frac{k_{3}}{3}+\frac{k_{4}}{6}
$$

なぜこの式で精度が高く計算できるのか，詳細は数値解析の授業に譲るが，４次のルンゲ・クッタ法は精度の高い常微分方程式の数値解法として広く用いられている．

---
## 問題
---

オイラー法，２次のルンゲ・クッタ法，４次のルンゲ・クッタ法を用いてニュートンの運動方程式の解を求めるプログラムを作成せよ．

ニュートンの運動方程式としては，粘性抵抗および慣性抵抗を含んだ二次元の運動方程式
$$
\frac{d\mathbf{v}}{dt} = -g\hat{y}-\alpha\mathbf{v}-\beta v\mathbf{v}
$$
を考える．

---
## 仕様
---

プログラムは以下の仕様を満たすこと．


---
### 参考情報
---
