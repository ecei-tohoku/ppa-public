---
layout: page
title: 1-3. トリム平均【基本】
---

スキー・ジャンプの飛型点の採点など，スポーツ競技の採点を複数の審判で行う際は，極端な採点による影響を抑えるため，審判員全員の採点を単純に平均するのではなく，最大値と最小値を外れ値として除外した平均がしばしば用いられる．トリム平均（trim mean），刈り込み平均（truncated mean），調整平均などと呼ばれる．
ここではこのトリム平均を求めるプログラムを作成しよう．

---
## 問題
---
標準入力からデータのサイズを表す整数$n$と，$n$個の実数値データを読み込み，そのデータから最大値と最小値を除外し，残った$n-2$個の実数値の平均値を標準出力に書き出すプログラムを作成せよ．

ただし，データのサイズは$3\le n\le 20$の範囲であると仮定してよい．また，入力される実数値は半角スペースで区切られて入力されると仮定してよい．
プログラムは以下の仕様を満たすこと．

1. 入力値は$-20$より大きく，$100$より小さい範囲（$-20<x<100$）とし，それ以外の値が一つでも入力された場合は`Out of Range`と出力して終了すること．
1. 最大値となるデータが複数ある場合は，そのうちの1つのみ除外すればよい．
1. 同様に，最小値となるデータが複数ある場合は，そのうちの1つのみ除外すればよい．
1. 出力する平均値は`printf`関数のフォーマット指定子を用い，小数点以下2位までを出力すること．
1. 各表示は標準出力に書き出し，末尾には改行文字`\n`を付けること．

---
## 実行例
---
`#`は標準入力，`>`は標準出力を表す．

```
# 7
# 19.0 18.0 19.5 18.0 17.0 18.5 18.0
> 18.30
```

```
# 10
# 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0
> 20.00
```


---
### 手順例
---

- 問題を分解して考える．
  1. 標準入力からデータのサイズ$n$と，$n$個の実数値データを読み込む
  1. そのデータから最大値と最小値を除外
  1. 残った$n-2$個の実数値の平均を計算
  1. 平均値を標準出力に書き出す

---
#### 0. 準備

- これまでと同様に，まず，確実に必要と思われるC言語のメインの構造を作る

#### 1. 標準入力からデータのサイズ$n$と，$n$個の実数値データを読み込む

- $n$は問題1-1, 1-2と同じ要領で読み込む．
- 「$n$回データを読み込む」ためにどうするか？
  - 何個かあらかじめ分からないので，`scanf`文を一回呼び出しただけでは読み込みができない！
```
  scanf("%lf %lf %lf %lf %lf %lf %lf", &x1,&x2,&x3,&x4,&x5,&x6,&x7); 
```
  - forループを使った読み込みが一番自然：
```
  double v;
  for (i = 0; i < ??; ++i) { // ??は適切なコードに修正すること
    scanf("%lf", &v);
    ...
  }
```

  - 配列を用意して一旦格納してもよい．
```
  double v[20];
  for (i = 0; i < ??; ++i) { // ??は適切なコードに修正すること
    scanf("%lf", &v[i]);
  }
```

- 不動小数点を扱う際には，32-bit単精度浮動小数点型`float`もしくは64-bit倍精度浮動小数点型`double`型を使うが，ここでは`double`型をつかうこと

---
### 2. そのデータから最大値と最小値を除外
---

- 読み込んだ値の中で最も大きい，最も小さいはどうやって判別するか？
```
  double tmax = x1;
  if( tmax < x2){
      tmax = x2;
  }
  if( tmax < x3){
 ...
```

```
for (i = 0; i < ??; ++i) {
  scanf("%lf", &v);
  if( tmax < v){
      tmax = v;
  }
}
```

---
### 3. 残った$n-2$個の実数値の平均を計算
---

- 平均するには和を計算する．
- 文字通り「残った$n-2$個だけで和をとる」だけでなく，他のやり方でも計算できる．
  
---
### 4. 平均値を標準出力に書き出す
---

- 出力はこれまでの課題と同様である
- ただし，出力フォーマットを間違えないように注意すること
  - よくわからない場合は，「参考情報」を参照


---
### 手順例まとめ
---

- これまでの課題と同様に，条件を満たす様に作成すること

---
## 参考情報
---
---
### 浮動小数点型の取り扱い
---
- 実数を計算機で取り扱う際には（有限桁で打ち止めとなる） **浮動小数点型** を用いる．
- `scanf`などの入力用関数，および`printf`などの出力用関数用いる **変換指定**（`%`ではじまる文字列，`int`型の場合は`"%d"`だった）は型によって異なるので注意すること．`double`型の場合，`scanf`には`%lf`を，`printf`には`%f`を使う（`printf`では他の書式もある）．
- 林：3.6 データ型の性質
- 倉：1巻 3-3 型
- 高橋：3.3 型

---
### 最大値，最小値の求め方
---
- C言語で最大値（最小値）を求める際は，仮の最大値（最小値）を格納する変数をひとつ用意しておいて，データをひとつずつ見ながらこの変数を更新していく方法が一般的である．
- C言語では，変数の初期値は自分でしなければいけないことに注意（仮の最大値を格納する変数に最初に`100000`が入っていたらどうなるだろう？）．

---
### `printf`のフォーマット文字列
---
- `printf`などの出力用変数は，データを出力する際の書式（整数を何進法で表示するか，浮動小数を何桁目まで表示するか，など）を指定することができる（`printf`のfはformatのf）．仕様や使い方は，**フォーマット文字列**，**書式指定子**，**フォーマット指定子**，**変換指定子**，などの語で探すことができる．
- 林：16.4 書式付き出力（`printf`）
- 倉：2巻 1-3 `printf()`徹底攻略
- 高橋：12.1 入出力の基本
- Linux Man pages：[PRINTF](https://linuxjm.osdn.jp/html/LDP_man-pages/man3/printf.3.html)

---
## 参考文献
---
+ Carl Bialik. [Removing Judges' Bias Is Olympic-Size Challenge](http://www.wsj.com/news/articles/SB10000872396390443477104577551253521597214). The Wall Street Journal. July 27, 2012.
