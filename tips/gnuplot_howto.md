---
layout: page
title: gnuplotの使い方
---
グラフ表示ソフトgnuplotの使い方の簡単な説明です。
詳細な情報を知りたいときは以下のホームページを参照してください。

[Gnuplotの第一歩](http://lagendra.s.kanazawa-u.ac.jp/ogurisu/manuals/gnuplot-intro/)


## 起動と終了

端末で 

`$ gnuplot`

と入力すると、gnuplotが起動します。起動後の表示 

`gnuplot> `

が、gnuplotのコマンドプロンプトです。 
終了するには gnuplot のコマンドプロンプトで、

`gnuplot> quit`

と入力します。

## 関数のプロット
まず，関数$y=sin(x)$をプロットしてみましょう。
gnuplot のコマンドプロンプトで、

`gnuplot> plot sin(x)`

と入力すると画面に$y=sin(x)$のグラフが表示されます。
次に2次関数$y=x+3x^2$をプロットしてみましょう。

`gnuplot> plot x + 3*x**2`

と入力すると画面に$y=x+x^2$のグラフが表示されます。
$x$の$n$乗は `x**n` と入力します。

## データのプロット

ファイルに保存されているデータをプロットする場合には

`gnuplot> plot 'filename'`

と入力します。(`filename`はプロットしたいファイルの名前です。)
データファイルには1行目に$x$座標、2行目に$y$座標が保存されて
いなければなりません。

試しに`/opt/local/enshu/data-2002/saisyou.dat`をプロットしてみましょう。
まず、gnuplot を起動する前に

`$ cp /opt/local/enshu/data-2002/saisyou.dat .`

と入力してデータファイルを自分のディレクトリにコピーします。
次に gnuplot を起動して

`gnuplot> plot 'saisyou.dat'`

と入力するとデータが点でプロットされます。
折れ線グラフでプロットする場合には

`gnuplot> plot 'saisyou.dat' with lines`

と入力します。

## 複数のグラフのプロット

複数のグラフを同時にプロットする場合にはコンマで区切って入力します。
$y=sin(x)$と$y=cos(x)$をプロットするには

`gnuplot> plot sin(x), cos(x)`

と入力します。
$y=sin(x)$を点で、$y=cos(x)$を線でプロットするには

`gnuplot> plot sin(x) with points, cos(x) with lines`

と入力します。
ファイルに保存されたデータをプロットする場合も同様に

`gnuplot> plot 'filename1' with points, 'filename2 with lines`

などと入力します。


## 複数のデータが入ったファイルのプロット

複数のデータが入ったファイルから，特定の列を指定してプロットしたい場合は，`using`という構文を利用することができます．

例えば，以下のような半角スペース区切りのデータ(ファイル名を仮に`test.txt`とする)から，特定の列をプロットすることを考えます．

```
> 20 81.80 82.25 83.33
> 21 82.04 82.07 83.24
> 22 83.38 82.20 83.26
> 23 83.36 82.40 83.30
> 24 82.90 82.70 83.26
> 25 83.32 83.00 83.23
> 26 83.12 83.22 83.20
> (途中省略)
> 1241 120.96 121.70 122.27
> 1242 120.15 121.23 122.15
> 1243 120.54 120.84 122.04
> 1244 120.39 120.65 121.92
> 1245 120.54 120.52 121.79
```

仮に一番目の列と二番目の列をプロットするならば，`using 1:2`と指定します．

具体的には，

`gnuplot> plot "test.txt" using 1:2 with lines`

のように記述すれば良いでしょう．

他の列のデータを同時にプロットしたい場合は，前節「**複数のグラフのプロット**」と組み合わせて，

`gnuplot> plot "test.txt" using 1:2 with lines, "test.txt" using 1:3 with lines`

と記述することができます．

## グラフに凡例をつける

一般に，複数のグラフを同時にプロットする場合，それぞれのグラフに名前(凡例,legend)をつけると分かりやすくなります．

特に指定をしない場合，プロット時の関数名やファイル名がそのまま凡例となりますが，自分で凡例をつけたい場合があります．

（同じファイルから複数のグラフを同時にプロットすると，凡例に同じファイル名が付いてしまうため）

その場合，`plot`コマンドの`title`オプションを使うと良いでしょう．

例えば，`test.txt`に記述された数値をプロットし，そのグラフに`MyGraph`という凡例をつけたいならば，

`gnuplot> plot 'test.txt' with lines title "MyGraph"`

と記述すれば良いでしょう．

## グラフに軸の名前をつける

レポートにグラフを載せるときは，グラフのx軸やy軸に名前をつける必要があります．

ラベル付けには，`set xlabel`や`set ylabel`構文が利用できます．

例えばx軸の名前を"Date"にしたい場合，

`gnuplot> set xlabel "Date"`

と入力すれば良いでしょう．
（既にグラフをプロット済の場合，ラベルを反映させるために`replot`コマンドが必要かもしれません）

## カンマ区切りのファイルの利用

`gnuplot> set datafile separator ","`

入力することにより、カンマ区切りのデータファイルをplotできます。

## グラフの印刷

プロットしたグラフをプリンタで印刷するには、まず

`gnuplot> plot sin(x)`

などのコマンドでグラフを画面上にプロットします。
画面上のグラフが印刷したいグラフであることを確認してから

`gnuplot> set terminal postscript`

`gnuplot> set output 'plot.ps'`

`gnuplot> replot`

と入力します。すると自分のディレクトリに`plot.ps`という名前のファイル
が作成されます。
次にgnuplotを終了して

`$ lpr plot.ps`

と入力するとプリンターに出力されます。

## Tips

実はgnuplotでは，端末と同様にカーソルキー上や`Ctrl+P`で履歴から以前入力したコマンドを再度利用することができます．

一部の`plot`コマンドなどは中身が長くなりがちですから，履歴をうまく活用して，効率的にグラフをプロットすると良いでしょう．

（逆にカーソルキー下や`Ctrl+N`では履歴を一つ先に進みます）

また`cd`や`pwd`などの一部のコマンドも利用可能ですから，試してみると良いでしょう．
