---
layout: page
title: 4-4. 数値積分【基本】
---

コンピュータはもともと，数式として解が出ない（解析解がない）物理方程式に対して近似解を求めるために実現されたという経緯がある．その手法は<font color=red>数値解析</font>と呼ばれ，今日でも盛んに研究が進んでいる分野である．この問題では，代表的な数値解析手法である<font color=red>数値積分</font>について学ぶ．

数値解析を考える上で常に念頭に置かなくてはいけないのは，コンピュータ上では実数を表現するための精度（ざっくり言うと小数点以下の桁数）が有限であるということである．関連して，数学で言う無限大，無限小といった極限操作ができないため，いかに有限の操作で精度良く計算するかがカギとなる．

もともとの積分の定義である「リーマン和の極限」

$$
S = \lim_{N=\infty}\sum_{i=1}^{N}f(\xi_{i})\Delta x_{i} = \int_{a}^{b}f(x)dx \\
x_{i} = (b-a)i/N+a (i=0, 2, ..., N) \\
\Delta x_{i} = x_{i}-x_{i-1} (i=1, 2, ..., N)\\
x_{i-1}\le\xi_{i}\le x_{i} (i=1, 2, ..., N)
$$

から一歩立ち戻り，有限和で近似するのが数値積分法である．ただし，図？？のようにリーマン和は長方形の面積で関数の積分を近似するため，精度が悪い．ここでは，同じ$N$でもっと精度高く数値積分ができる方法をいくつか実装してもらう．

1. 台形則
  積分範囲$[a, b]$を

$$
\int_{x_{1}}^{x_{2}}f(x)dx \simeq h\left(\frac{1}{2}f_{1}+\frac{1}{2}f_{2}\right)
$$

$h = x_{2}-x_{1}$

$$
\int_{a}^{b}f(x)dx \simeq h\left(\frac{1}{2}f_{1}+f_{2}+f_{3}+\cdots+f_{N-1}+\frac{1}{2}f_{N}\right)
$$

3. Simpson則
4. 
$$
\int_{x_{1}}^{x_{3}}f(x)dx \simeq h\left(\frac{1}{3}f_{1}+\frac{4}{3}f_{2}+\frac{1}{3}f_{3}\right)
$$

$$
\int_{a}^{b}f(x)dx \simeq h\left(\frac{1}{3}f_{1}+\frac{4}{3}f_{2}+\frac{2}{3}f_{3}+\frac{4}{3}f_{4}+\cdots+\frac{2}{3}f_{N-2}+\frac{4}{3}f_{N-1}+\frac{1}{3}f_{N}\right)
$$

5. Simpson3/8則


---
## 問題
---

台形則，Simpson則，Simpson3/8則に基づく数値積分を行なう関数を作成し，それらを使って数学関数を積分するプログラムを作成せよ．

---
## 仕様
---

プログラムは以下の仕様を満たすこと．

- 入力は，数学関数の番号（後述）である整数$n$ ($n = 1, 2, 3, 4)と，積分を行なう範囲$[a, b]$を指定する実数$a$，$b$とする：

  ```
  n a b
  ```
- 数学関数を定義するにあたり，`math.h`ヘッダをインクルードすること．
- 数学関数は以下の４つ，$f_{1}(x), ..., f_{4}(x)$である．対応するプログラム上の関数`double f1(double x), ..., double f4(double x)`を定義すること．
  - $f_{1}(x) = ...$ → `double f1(double x){ return ???; }`
  - $f_{2}(x) = ...$ → `double f2(double x){ return ???; }`
  - $f_{3}(x) = ...$ → `double f3(double x){ return ???; }`
  - $f_{4}(x) = ...$ → `double f4(double x){ return ???; }`
- 台形則，Simpson則，Simpson3/8則に基づく数値積分を行なうための関数をそれぞれ１つずつだけ作成すること．各関数は，第一引数を関数ポインタ（），第二引数を`double`型の積分開始点$a$，第二引数を`double`型の積分終了点$b$とし，積分結果を`double`型で返すこと：

  ```
  double integral_trapezoid(double (*f)(double x), double a, double b);
  double integral_Simpson(double (*f)(double x), double a, double b);
  double integral_Simpson_3_8(double (*f)(double x), double a, double b);
  ```
- 出力は，台形則，Simpson則，Simpson3/8則に基づいた数値積分の値を，空白で区切って出力すること（末尾には空白は付けない）．
- 各行の末尾には改行文字`\n`を出力すること．

---
### ステップに分けてプログラミング
---
この問題では，「関数ポインタの動作確認」「台形則に基づく数値積分の実装」「Simpson則，Simpson3/8則に基づいた数値積分の実装」の3ステップに分けてプログラミングしてもらう．ステップごとに"動作確認"に成功しなければ，"TAに提出"が出来ないようになっている．以下では，各ステップをさらに細分化して説明する．

---
### ステップ1/3　「関数ポインタの動作確認」
---

---
### ステップ2/3　「台形則に基づく数値積分の実装」
---
---
### ステップ3/3　「Simpson則，Simpson3/8則に基づいた数値積分の実装」
---


---
## 実行例
---

+ 入力
```

```

+ 出力
```

```
```

```



---
### 参考情報
---

---
#### C言語における数学関数ライブラリ
---

---
#### 関数ポインタ
---
- 
- 
