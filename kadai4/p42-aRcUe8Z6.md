---
layout: page
title: 4-2. 単純移動平均【初歩】
---

[単純移動平均 (SMA: Simple Moving Average)](https://ja.wikipedia.org/wiki/%E7%A7%BB%E5%8B%95%E5%B9%B3%E5%9D%87)を用いた金融データ（為替レート）の分析を体験しよう．

単純移動平均は，時系列データの傾向を調べる際しばしば用いられる指標であり，
形式的には，$N$日分の観測値からなる時系列データ$x_1, x_2, ..., x_N$に対して，日付$t$における，$M$日の単純移動平均は次式で定義される．
簡単に言えば，時系列データの各時点$t$における「当日から$M-1$日前までの平均」のことである：

$$ {\rm SMA}^{(M)}_t = \frac{x_t + x_{t-1} + ... + x_{t-M+1}}{M} $$

投資では，短期移動平均線（例えば${\rm SMA}^{(5)}$）が長期移動平均線（例えば${\rm SMA}^{(20)}$）を下から上に突き抜けた時をゴールデンクロスと呼び，買い（上昇トレンド）のシグナルとして用いられる．逆に，短期移動平均線が長期移動平均線を上から下に突き抜けた時をデッドクロスと呼び，売り（下降トレンド）のシグナルとして用いられる．下の図はある時系列データに対して5日単純移動平均，20日単純移動平均を取ってプロットした結果である．

。。。図。。。

より一般的には，連続するデータの上がり下がりが激しい場合に，その点の周りで平均を取ることで”データの傾向”を統計的に調べることができ，物理実験の測定データなどの解析によく用いられる手法である．

ここでは，$M$日単純移動平均を求めるプログラムを作成しよう．



---
## 問題
---

標準入力からデータ数$N$，単純移動平均を計算する日数$M$，$N$個の観測値からなる時系列データ$x_1, x_2, ..., x_{N}$を読み込み，標準出力に日付$t$，観測値$x_t$, $M$日単純移動平均${\rm SMA}^{(M)}_t$を出力するプログラムを書け．

---
## 仕様
---

- 入力，浮動小数点，doubleを用いること（floatは用いないこと）入力される$M$は$1<=M<=20$であると仮定してよい．また入力される$N$は$M<=N<=100$であると仮定してよい．
- 出力，
1. $x_t$, ${\rm SMA}^{(5)}_t$, ${\rm SMA}^{(20)}_t$はそれぞれ`printf`関数のフォーマット指定子を用い，小数点以下2位までを出力すること
2. 日付$t=M$から$t=N$までを出力．
3. 各行の数値の間には空白文字を入れること
4. 各行の末尾には改行文字`\n`を付けること
- 動的メモリ確保，解放
- $M$日単純移動平均を計算する関数を作成すること。。。

---
## 実行例
---
  - 入力例1

  ```
  10 2
  
  ```

  - 出力例1
  ```
  ```
  
  - 入力例2

  ```
  100 20
83.78 82.92 82.61 83.62 83.98 83.82 83.95 83.56 83.87 84.25 84.06 84.09 83.74 122.15 110.54 100.84 122.04 120.39 83.83 83.19 82.97 82.72 82.33 81.44 81.84 92.04 93.39 93.36 92.91 93.32 93.12 82.81 82.93 82.77 82.64 82.17 83.05 82.72 82.63 82.24 82.11 82.77 82.93 82.77 81.84 100.96 121.70 112.27 100.15 121.23 91.06 21.09 83.74 83.83 93.19 82.97 82.72 92.33 81.44 91.21 100.65 121.92 100.54 100.52 121.79 122.22 102.27 120.15 121.23 111.11 82.04 83.38 83.36 82.91 83.32 83.12 82.81 82.93 82.77 82.64 102.27 120.15 121.23 111.11 84.06 84.09 83.74 83.83 83.19 82.97 82.72 82.33 81.44 81.84 100.65 121.92 100.54 100.52 121.79 122.22
  ```

  - 出力例2
  ```
  20 83.19 91.56
  21 82.97 91.52
  22 82.72 91.51
  23 82.33 91.50
  24 81.44 91.39
  25 81.84 91.28
  26 92.04 91.69
  27 93.39 92.16
  28 93.36 92.65
  29 92.91 93.11
  30 93.32 93.56
  31 93.12 94.01
  32 82.81 93.95
  33 82.93 93.91
  34 82.77 91.94
  35 82.64 90.54
  36 82.17 89.61
  37 83.05 87.66
  38 82.72 85.78
  39 82.63 85.72
  40 82.24 85.67
  41 82.11 85.63
  42 82.77 85.63
  43 82.93 85.66
  44 82.77 85.73
  45 81.84 85.73
  46 100.96 86.17
  47 121.70 87.59
  48 112.27 88.53
  49 100.15 88.89
  50 121.23 90.29
  51 91.06 90.19
  52 21.09 87.10
  53 83.74 87.14
  54 83.83 87.20
  55 93.19 87.72
  56 82.97 87.76
  57 82.72 87.75
  58 92.33 88.23
  59 81.44 88.17
  60 91.21 88.62
  61 100.65 89.54
  62 121.92 91.50
  63 100.54 92.38
  64 100.52 93.27
  65 121.79 95.27
  66 122.22 96.33
  67 102.27 95.36
  68 120.15 95.75
  69 121.23 96.80
  70 111.11 96.30
  71 82.04 95.85
  72 83.38 98.96
  73 83.36 98.94
  74 82.91 98.90
  75 83.32 98.40
  76 83.12 98.41
  77 82.81 98.42
  78 82.93 97.95
  79 82.77 98.01
  80 82.64 97.58
  81 102.27 97.66
  82 120.15 97.58
  83 121.23 98.61
  84 111.11 99.14
  85 84.06 97.25
  86 84.09 95.35
  87 83.74 94.42
  88 83.83 92.60
  89 83.19 90.70
  90 82.97 89.30
  91 82.72 89.33
  92 82.33 89.28
  93 81.44 89.18
  94 81.84 89.13
  95 100.65 89.99
  96 121.92 91.93
  97 100.54 92.82
  98 100.52 93.70
  99 121.79 95.65
  100 122.22 97.63
```

---
## 余談
---
移動平均の応用は，信号処理全般にわたって広がっている．画像処理では，画像のノイズを除去して滑らかにするために移動平均が用いられる．音声処理では，移動平均は有限インパルス応答（FIR）フィルタの特殊形であり，ローパスフィルタ（LPF）として用いることができる．
