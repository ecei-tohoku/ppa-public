---
layout: page
title: 2-4. マージ関数の作成【自動採点システム:5点，仕様:5点】
---

マージソートのアルゴリズムは与えられた配列データを小さな部分配列に分割し，部分配列ごとにソートを行なう分割統治法の代表的アルゴリズムの一つである．ここでは，マージソートのアルゴリズムの準備として，ソート済みの小さな部分配列を合成してソートされた大きな部分配列を作成する**マージ**という手順を行なうマージ関数を作成してみよう．

## 問題

与えられた配列データ array[$0$] 〜 array[$n-1$] の部分配列 array[$p$] 〜 array[$q$] と array[$q+1$] 〜 array[$r$] $(p \leq q < r < n)$ をマージするプログラムを作成せよ．

プログラムは以下の仕様を満すこと（以下の仕様を満たしたプログラムに5点を加点する）．

- グローバル変数や静的変数を使用してはいけない．
- プログラムへの入力となるデータファイルの内容は，以下の通りである．
  - データファイルの 1 行目に，配列データの個数 $n$ が記載されている．
  - データファイルの 2 行目に，部分配列を指定する 3 個の整数 $p,q,r(p \leq q < r < n)$ が記載されている．
  - データファイルの 3 行目に，$n$ 個のデータが半角スペースで区切られて記載されている．
  - すべてのデータの値は，`int` 型で収まる範囲内にある正の整数となっており， 2 行目で指定される部分配列は既にソートされているものとする．
- 配列の動的確保
  - $n$ 個の配列データを読み込む際には，データの格納に必要なメモリ領域を動的に確保すること．
  - 動的に確保したメモリ領域は処理が完了した後に解放すること．
- データファイルの読み込みは`main` 関数内で行うこと.
- ソートされた部分配列 array[$p$] 〜 array[$q$] と array[$q+1$] 〜 array[$r$] をマージする `merge` 関数を作成すること．ただし， `merge` 関数は以下の仕様を満すこと．
  - 動的に確保した $n$ 個のデータの配列と 3 個の整数 $p,q,r$ を引数とすること．
  - マージの際に実行された，二つの数値の比較の回数を返す関数であること．
  - 必要があれば配列データのメモリ領域を動的に確保すること．確保されたメモリ領域については，所望の処理が完了した後に適宜解放すること．
- マージ後の出力
    - 配列データ全体の各要素を標準出力に書き出し，改行後に比較回数を書き出すこと．
	- `merge` 関数内で比較した回数を表示してはいけない．
    - `merge` 関数内でマージ後の配列データを表示してはいけない．
- 配列データの表示は各要素を半角スペースで区切って標準出力に書き出し，各表示の末尾には改行文字 `\n` を付けること．
	- 配列データを表示する際に最終要素と改行文字 `\n` の間に半角スペースをいれないこと．

## 実行例

### (1)

入力されるデータファイル ([merge_data1.txt](./merge_data1.txt)) の例

```
4
1 2 3
1 2 3 4
```

リダイレクション '<' を用いて `merge_data1.txt` の内容を標準入力から読み込む．

```
$ ./a.out < merge_data1.txt
```

`merge_data1.txt` に対する実行結果の例（`>` は標準出力を示し，`⊔` は半角スペースを示す．）

```
> 1⊔2⊔3⊔4
> 2
```

### (2)

入力されるデータファイル ([merge_data2.txt](./merge_data2.txt)) の例

```
8
1 4 7
2 1 3 4 8 5 6 7
```

`merge_data2.txt` に対する実行結果の例（`>` は標準出力を示し，`⊔` は半角スペースを示す．）

```
> 2⊔1⊔3⊔4⊔5⊔6⊔7⊔8
> 6
```

### (3)

入力されるデータファイル ([merge_data3.txt](./merge_data3.txt)) の例

```
10
2 5 7
3 2 1 4 11 15 6 9 8 7
```

`merge_data3.txt` に対する実行結果の例（`>` は標準出力を示し，`⊔` は半角スペースを示す．）

```
> 3⊔2⊔1⊔4⊔6⊔9⊔11⊔15⊔8⊔7
> 4
```

## ヒント

- マージソートのアルゴリズムにおけるマージについては，[課題解説資料](http://ecei-tohoku.github.io/ppa/tmp_kadai2_2017/kadai2-intro.pdf) p.17 も参考のこと．
- 下記のような考えのもと `merge` 関数を書いてみよう．
    1. まず，作業用の配列 $T$ を用意する．
    2. array[$p$] と array[$q+1$] を比較する．仮に array[$p$] の方が小さかったとしよう．$T[0]$ に array[$p$] を代入する
    3. array[$p+1$] と array[$q+1$] を比較する．仮に array[$q+1$] の方が小さかったとしよう．$T[1]$ に array[$q+1$] を代入する
    3. array[$p+1$] と array[$q+2$] を比較する．仮に array[$q+2$] の方が小さかったとしよう．$T[2]$ に array[$q+2$] を代入する
    4. ...
    - このような処理を繰り返していけば，$T$ は二つの部分配列のマージの結果となっているはずである．あとは $T$ を array[$p$] 〜 array[$r$] に書き戻せばよい．
