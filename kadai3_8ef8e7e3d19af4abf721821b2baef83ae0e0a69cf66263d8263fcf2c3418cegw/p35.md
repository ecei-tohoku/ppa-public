---
layout: page
title: 3-5. 共通部分文字列のマッチング数
---

---
## 問題
---
二つの文字列$X$と$Y$が与えられる．
この$X$と$Y$の共通部分文字列のマッチング数を動的計画法を用いて求めよ．

---
### 仕様
---
+ 課題3-0に記載の課題全体の仕様

+ 共通部分文字列のマッチング数を標準出力に表示せよ
+ 共通部分文字列のマッチング数を計算する際には，以下の再帰式に基づいた計算を行うと共に，動的計画法を用いて計算せよ．

$$
K{X,Y} =\sum_i \sum_j k_0 (X, Y) 
$$

$$
K_0(X_i,Y_j) =\begin{cases}
K_2(X_i,Y_j) \quad x_i = y_j \mbox{ のとき} \\
0  \quad\quad\mbox{ それ以外} \\
\end{cases}
$$

$$
K_1(X_i,Y_j) =\begin{cases}
0 \quad\quad i=0, \mbox{ or } j=0 \mbox{ のとき} \\
K_1(X_{i-1}, Y_j) + K(X_{i-1}, Y_j) \quad \mbox{ それ以外} \\
\end{cases}
$$

$$
K_(X_i,Y_j) =\begin{cases}
0 \quad\quad i=0, \mbox{ or } j=0 \mbox{ のとき} \\
K_2(X_{i}, Y_{j-1}) + K(X_{i}, Y_{j-1}) \quad \mbox{ それ以外} \\
\end{cases}
$$

+ 動的計画法の2次元テーブル$K_0$, $K_1$, $K_2$をそれぞれ表示せよ

+ 最後に共通部分文字列のマッチング数を表示せよ

---
## 入出力例
---
---
### 例1
---

+ 入力データ
```
eat ate
```

+ 出力例
```
eat 3
ate 3
### k0
#   0   0   1
#   1   0   0
#   0   2   0
### k1
#   0   0   0
#   0   0   1
#   1   0   1
### k2
#   0   0   0
#   0   0   0
#   0   1   1
4
```

---
### 例2
---

+ 入力データ
```
abababab abcabcabc
```

+ 出力例
```
abababab 8
abababc 7
### k0
#   1   0   1   0   1   0   0
#   0   2   0   3   0   4   0
#   1   0   4   0   8   0   0
#   0   3   0  10   0  22   0
#   1   0   8   0  26   0   0
#   0   4   0  22   0  70   0
#   1   0  13   0  61   0   0
#   0   5   0  40   0 171   0
### k1
#   0   0   0   0   0   0   0
#   1   0   1   0   1   0   0
#   1   2   1   3   1   4   0
#   2   2   5   3   9   4   0
#   2   5   5  13   9  26   0
#   3   5  13  13  35  26   0
#   3   9  13  35  35  96   0
#   4   9  26  35  96  96   0
### k2
#   0   0   0   0   0   0   0
#   0   1   1   2   2   3   3
#   0   1   3   4   7   8  12
#   0   2   4   9  12  21  25
#   0   2   7  12  25  34  60
#   0   3   8  21  34  69  95
#   0   3  12  25  60  95 191
#   0   4  13  39  74 170 266
482
```

---
## ヒント
---
