---
layout: page
title: 1-5. 正規表現【発展】
---

文章の中で，ある語が登場する位置を検索したい．例えば，

{% highlight text %}
My favorite color is blue.
{% endhighlight %}

という文章では，`color`という単語は12番目（配列のインデックス．文字数で言うと13字目）から始まる（空白も1文字にカウントしていることに注意）．この探索をプログラムに実装する場合は，文章が入っている文字配列の先頭から順に，探したい語が入っている文字配列と照合していくのが最も実装が簡単なアルゴリズムである（より高速なアルゴリズムは存在するが，この問題では触れない）．このような問題を文字列マッチングと呼ぶ．
一方で，`color`とは綴りが異なる`colour`でも検索に引っかかるようにしたい場合もある：

  ```text
  My favorite colour is blue.
  ```

このように，検索したい語に複数パターンを含めたい場合，**正規表現**(**Regular Expression**あるいは**regex**)という特殊な記法を用いることで，`color`と`colour`を“一語”でまとめて表現することができる．具体的には，

  ```text
  colou?r
  ```
    
という正規表現が，`color`と`colour`の二つを同時に表す．`?`は「直前の文字が0個または1個ある」ことを表す正規表現の一つである．

この問題では，文字列$a$から，正規表現を含む文字列$b$にマッチする全ての文字列を出力するプログラムを作成する．用いる正規表現は，実装が比較的容易なものに限定し，使用条件も一部限定する．より詳細かつ厳密な正規表現の説明は[こちらを参照](https://ja.wikipedia.org/wiki/%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE)のこと．

---
## 正規表現の種類
---

1. 正規表現以外の文字（この問題ではアルファベットに限る）は，その文字自体にマッチングし，それ以外にはマッチングしない．例えば文字列`abcdef`の中では，正規表現`cd`は`cd`にマッチングする．例えば文字列`ababab`の中では，正規表現`ba`は1番目から始まる`ba`および3番目から始まる`ba`の２つにマッチングする．

2. `.`は，任意の文字1個にマッチングする．例えば文字列`abcdef`の中では，`c.e`は`cde`にマッチングする．必ず1文字なければいけないので，`c.d`にマッチングする文字列はない．また，連続での使用`c..f`や先頭文字への使用`.b`も許されていることに注意が必要である．前者は`cdef`に，後者は`ab`にマッチングする．連続した使用や，`.`のみで構成された表現も認められる．例えば文字列`abcdef`の中で，`..`は任意の連続した2文字の文字列，すなわち`ab`，`bc`，`cd`，`de`，`ef`にマッチングする．

3. `^`は，文字列の先頭のみマッチングすることを指定する．例えば`abcdef`の中では，`^ab`とすると先頭の`ab`がマッチングするが，`^bc`としてもマッチングする文字列はない．

4. `$`は，文字列の末尾のみマッチングすることを指定する．例えば`defdef`の中では，`def$`は4文字目の`def`にしかマッチングしない．実装上で注意するべき点は，`def?$`のような正規表現も許されるということである．この場合には末尾が`de`あるいは`def`で終わっていればマッチングする．

5.`[…]`は，カッコ内に書かれた複数文字の中から１個にマッチングする．例えば`GooglegoogleHooglehoogle`の中では，`[Ggh]oogle`は0番目の`Google`，6番目の`google`，18番目の`hoogle`にマッチングする．

6. `?`は，直前の文字0個または1個にマッチする．例は上に述べたとおり．本来の正規表現では`.?`や`[abc]?`のような表現も許されるが，この問題では実装が煩雑になる恐れがあるので，`?`の前には必ずアルファベットがあると仮定する．


---
## 問題
---
文字列$a$と正規表現$b$を入力として，$a$の中から$b$にマッチングする全ての文字列を見つけ，その開始文字の番号と文字列を出力するプログラムを作成せよ．


### 入力の仕様

入力は以下の４行で与えられる：

  ```text
  m
  a
  n
  b
  ```
    
$m$は$1<=m<=100$を満たす整数で，文字列$a$の長さを表し，$a$はアルファベットのみで構成された文字配列（空白も含まれない）である．$n$は$1<=n<=200$を満たす整数で，正規表現$b$の長さを表し，$b$はアルファベットと正規表現を表す記号のみで構成された文字配列（空白も含まれない）である．

正規表現$b$に関しては，以下の仮定をしてよい：
- `^`と`$`は同時には出てこない．
- `[]`の中は必ず1文字以上の文字で構成され，正規表現用の文字は出てこない．また，括弧に関する文法エラーはない（片方のみしかない，順序が逆，など）．
- `?`の前には必ずアルファベットが1文字以上登場する．
- `?`の直後に`.`は出てこない．
- `?`の直後にはアルファベット文字，`$`，あるいは正規表現の末尾しか出てこない．
- `?`の直後にアルファベット文字がある場合，`?`の前後の文字は異なる．
- `?`の直後にアルファベット文字がある場合，このアルファベット文字の直後に`?`は出てこない．

文字列の入力には`fgets`関数あるいは`scanf`関数を用いること．また，文字配列は，入力されうる最大の文字列長とヌル文字を入れて十分な大きさを確保すること．

### 出力の仕様

一つでもマッチングする文字列が見つかった場合，その文字列の開始番号，半角空白，文字列，改行の順で出力する．複数個該当する場合は，開始番号が小さい順に出力すること．

  ```text
  i1 s1
  i2 s2
  ...
  ik sk
  ```

一つもマッチングしなかった場合は

  ```text
  No matching found.
  ```
  
  と出力すること．末尾の改行も忘れずに出力すること．

### その他の仕様
1. `#include` していいのは `<stdio.h>`のみとする．
1. プログラムの要約や意図を記述するコメントを書くこと．
1. インデント・行間を適切に入れること。


### ヒント
1. テストケースは正規表現の種類1~6を順に実装していけば，単体のテスト，前の機能との組み合わせのテストが順にできるようになっている．
2. 機能3の実装では，特に`?`との組み合わせの場合に複雑な処理が必要になる恐れがあるので，マッチングの処理時間を気にして末尾だけマッチングを確かめるようなコードを書く必要はない．


---
## 実行例
---
---
### 実行例(1)
---
- 入力
```
6
ababab
2
ba
```
- 出力
```
1 ba
3 ba
```
---
### 実行例(2)
---
- 入力
```
8
cdefcaaf
4
c..f
```
- 出力
```
0 cdef
4 caaf
```
---
### 実行例(3)
---
- 入力
```
8
cdefcaaf
5
^c..f
```
- 出力
```
0 cdef
```
---
### 実行例(4)
---
- 入力
```
8
cdefcaaf
5
c..f$
```
- 出力
```
4 caaf
```
---
### 実行例(5)
---
- 入力
```
24
GooglegoogleHooglehoogle
10
[Ggh]oogle
```
- 出力
```
0 Google
6 google
18 hoogle
```
---
### 実行例(6)
---
- 入力
```
18
colorcolourcolouur
7
colou?r
```
- 出力
```
0 color
5 colour
```
