---
layout: page
title: 3-3. 動的計画法　【10点，2週目のみ採点】【プログラム提出不要】
---

### 動的計画法

課題 3-2 のプログラムでは，文字列 $X$ と $Y$ の編集距離 $c_{m,n}$ を，与えられた文字列長から順に遡って（$c_{m, n}, c_{m-1, n-1}, c_{m, n-1}, ..., c_{0,0}$）再帰的に計算した．しかし，この方法では，同じ値を複数回計算してしまう可能性があるため，効率面で問題がある．本課題では，編集距離をより効率的に計算する方法の一つとして，**動的計画法 (Dynamic Programming)** に基づく編集距離の計算を考える．

編集距離の漸化式より，$c_{i,j}$ を求めるためには，$c_{i-1,j-1}, c_{i-1,j}, c_{i,j-1}$ の3つの値が必要である．これを視覚的に理解するために，課題 3-0 の表を思い出して欲しい（一部変更済み）:

| $i \setminus j$ | 0 |   1   |   2   |   3   | 4 | 5 | 6 | 7 | $x_i$ |
|:---------------:|:-:|:-----:|:-----:|:-----:|:-:|:-:|:-:|:-:|:-----:|
|      **0**      | 0 |   1   |   2   |   3   | 4 | 5 | 6 | 7 |       |
|      **1**      | 1 | ``1`` | ``2`` | ``2`` | 3 | 4 | 5 | 6 |   Q   |
|      **2**      | 2 | ``2`` | ``A`` | ``B`` | 2 | 3 | 4 | 5 |   U   |
|      **3**      | 3 |   3   |   3   |   3   | 3 | 3 | 4 | 5 |   E   |
|      **4**      | 4 |   4   |   4   |   4   | 4 | 4 | 3 | 4 |   R   |
|      **5**      | 5 |   5   |   5   |   5   | 5 | 5 | 4 | 4 |   Y   |
|      $y_j$      |   |   I   |   N   |   Q   | U | I | R | E |       |
{: .table .table-striped}

表の上では，とある編集距離 ($c_{i,j}$) を計算するためには，(1) その左上 ($c_{i-1,j-1}$)，(2) その左隣 ($c_{i,j-1}$)，(3) その真上 ($c_{i-1,j}$) の値が必要である．裏を返せば，これらの3つの値が計算済みであれば，それらの全てに隣接するマスの値を計算できるということである．つまり，左上から順に，$c_{1,1},c_{1,2},...$ というように値を五月雨式に埋めることができ，最終的に編集距離 $c_{m,n}$ が求まるということである．

例えば，$c_{2,2}$ (``A``) は，$c_{1,1},c_{1,2},c_{2,1}$ （``1``, ``2``, ``2``）を参照すれば，$min(1+1,2+1,2+1)=2$ と求まる．同様に，右に1マスずれて，$c_{2,3}$ (``B``) は，先ほどの計算結果を利用し，$c_{1,2},c_{2,2},c_{1,3}$ （``2``, ``A``=2, ``2``）を参照すれば，$min(2+1,2+1,2+1)=3$ と求まる．同様に右下のマスまで計算をしていけば，すべてのマスが埋まり，最後に求まった $4$ が，文字列 $X$ と $Y$ の編集距離 $c_{m,n}$ である．

以上のように，再帰計算の深いところから順に値を求めていく（**ボトムアップに求める**，ともいう）方法は，**動的計画法** として知られている．動的計画法を用いることで，計算回数を $X$ と $Y$ の文字列長の積 $mn$ に抑えることができ，重複して部分的な編集距離を計算することはないため，単純な再帰計算を用いるプログラムよりも多くの場面で効率的である．


### 課題

1. 動的計画法を用いて，$X = \mbox{"rhythm"}$，$Y = \mbox{"rime"}$の編集距離を求めよ．
2. $c_{i,j}$の漸化式を$c_{0,j}$および$c_{i,0}$を出発点として，手作業でボトムアップに計算し，すべての$c_{i,j}$の値を全て求めよ．$c_{i,j}$の値は，上記のような表形式でレポートにまとめよ．


### 参考資料

- [秋葉 拓哉, プログラミングコンテストでの動的計画法](http://www.slideshare.net/iwiwi/ss-3578511)
